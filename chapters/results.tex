
\chapter{بارسپاری کارآمد لبه شبکه برای نسل چهارم صنعت:}\label{chap:model}

\section{مزاحمت برنامه‌های کاربردی}

\subsection{جمع‌آوری داده مزاحمت}

\subsubsection{انتخاب مجموعه نرم‌افزارهای معیار}

\subsection{فرایند اندازه‌گیری مزاحمت}

\subsubsection{چیدمان ماشین‌های مجازی}

\section{سیستم مدل پزدارش لبه شبکه در نسل چهارم صنعت}

\subsection{ارسال و دریافت داده برای بارسپاری}

\subsection{مدل مزاحمت}

\section{فرمول‌بندی مساله بهینه‌سازی}

\begin{table*}[h!]
\begin{center}
\caption{List of constants, variables, and sets along with their corresponding definitions.\label{tab:var_list}}
\begin{tabular}{ |l|l|l|l| }
\hline
Type & Notation & Description & Value \\ 
\hline
\multirow{5}{*}{\rotatebox[origin=c]{90}{Sets}} 
& $n$ & interference indices & $\{0, 1, \dots, 8\}$ \\
& $e \in \mathbb{E}$ & Set of entities (robots and sensors) & $\{1, 2, \dots, |E|\}$ \\
& $s \in \mathbb{S}$ & Set of MEC servers & $\{1, 2, \dots, |S|\}$ \\
& $a \in \mathbb{A}$ & set of applications & $\{1, 2, \dots, |A|\}$ \\
& $k \in \mathbb{K}$ & Set of tasks of entities & $\{1, 2, \dots, |K|\}$ \\
& $\mathbb{K}_e$ & tasks generated by $e$ & e.g. $\{3, 4, \dots \}$ \\
& $\mathbb{K}_s$ & tasks offloaded to server $s$ & e.g. $\{3, 4, \dots \}$ \\
& $a(k)$ & application $a$ requested by task $k$ & \\
& $m \in \mathbb{M}$ & Unordered container combinations on server & \\
& $\mathbb{A}_m$ & applications in one combination & e.g. $(a_1,a_3, ..., |\mathbb{A}_m|)$ \\
\hline
\multirow{11}{*}{\rotatebox[origin=c]{90}{Parameters}}
& $\mathcal{M}$ & Maximum number of containers on MEC server & $6$\\
& $\beta$ & interference coefficients vector & \\
& $P_{a_k}$ & interference vector for application of task $k$ & \\
& $I_k$ & Input size of task $k$ & $10$ Megabytes \\
& $O_k$ & Output size of task $k$ & $100$ Kilobytes \\
& $L_k$ & CPU cycles required for task $k$ & $10^8$ cycles \\
& $\Theta_k$ & Maximum tolerable delay for task $k$ & 1 s \\
& $F_s$ & CPU capacity of server $s$ & $2 \times 10^9$ cycles/s \\
& $F_e$ & CPU capacity of entity $e$ & $10^8$ cycles/s \\
& $f_k$ & CPU power allocated to task $k$'s container & $5 \times 10^8$ cycles/s \\
& $R_{w,e,s}$ & Wireless rate between $e$ and AP connected to $s$ & $5 \times 10^7$ bits/s \\
& $R_{f,s}$ & Wired transmission rate to server $s$ & $10^8$ bits/s \\
& $C_{k,\mathbb{A}_m}$ & Slowdown by interference from combination $m$ for $k$ & \\
\hline
\multirow{2}{*}{\rotatebox[origin=c]{90}{Var.}} 
& $x_{k,e,s}$ & 1 if $k$ from $e$ offloaded to $s$, 0 otherwise & binary\\
& $x_{k,e,0}$ & 1 if $k$ processed locally on $e$, 0 otherwise & binary\\
& $z_{s,m}$ & 1 if server $s$ selects combination $m$, 0 otherwise & binary\\
\hline
\end{tabular}
\end{center}
\end{table*}

\subsection{فرمول پیشنهادی تداخل منابع}

Interference from application $a_2$ to $a_1$ requested by task $k$ is calculated for combination $\mathbb{A}_m=\{a_1,a_2\}$:
\begin{equation} \label{mutual_interference}
    C_{k,\mathbb{A}_m} = \beta_0 + \sum_{n=1}^4 \beta_n P_{a_1,n} + \sum_{n=1}^4 \beta_{n+4} P_{a_2,n}
\end{equation}
and when $a_3$ collocates with them too ($\mathbb{A}_m=\{a_1,a_2,a_3\}$, $a_2$ requested by $k'$, $a_3$ requested by $k"$ and $\mathbb{A}'_m=\{a_2,a_3\}$ excludes the application calculating interference for it):
\begin{multline} \label{triple_interference}
    C_{k,\mathbb{A}_m} = \beta_0 + \sum_{n=1}^4 \beta_n P_{a_1,n} + \\ \sum_{n=1}^4 \beta_{n+4} \left(P_{a_2,n}C_{k',\mathbb{A}'_m} + P_{a_3,n}C_{k",\mathbb{A}'_m}\right)
\end{multline}
to sum up, the interference calculation is presented in \ref{total_interference}:
\begin{multline} \label{total_interference}
    C_{k,\mathbb{A}_m} = \beta_0 + \sum_{n=1}^4 \beta_n P_{a(k),n} + \\ \sum_{n=1}^4 \beta_{n+4} \left(\sum_{j \in \mathbb{K}_s} P_{a(j),n} C_{j,\mathbb{A}'_m}\right)
\end{multline}

\subsection{قیود و تابع هدف مساله بهینه‌سازی}

\subsubsection{تصمیم‌گیری بارسپاری}

\begin{equation} \label{task_assignment}
    \sum_{s \in \mathbb{S}} x_{k,e,s} \leq 1 \quad \forall k \in \mathbb{K}_e, e \in \mathbb{E}
\end{equation}

\begin{equation} \label{cont_num}
    \sum_{k \in \mathbb{K}_e, e \in \mathbb{E}} x_{k,e,s} \leq \mathcal{M} \quad \forall s \in \mathbb{S}
\end{equation}

\subsubsection{چیدمان ماشین‌های مجازی}
Introduced $z_{s,m}$ as application arrangement variable in server $s$. Application layout of each server is defined based on \ref{app_layout}:

\begin{equation} \label{app_layout}
    \sum_{m \in \mathbb{M}} z_{s,m} \leq 1 \quad \forall s \in \mathbb{S}
\end{equation}

\begin{multline} \label{zx_match}
    z_{s,m} \leq x_{k,e,s} \quad \forall a(k) \in \mathbb{A}_m, k \in \mathbb{K}_e, e \in \mathbb{E}, s \in \mathbb{S}, \\ m \in \mathbb{M}
\end{multline}

\begin{multline} \label{zx_match2}
    z_{s,m} \geq \sum_{\substack{a(k) \in \mathbb{A}_m\\ k \in \mathbb{K}_e, e \in \mathbb{E}}}x_{k,e,s} - |\mathbb{A}_m| + 1 \\ \forall s \in \mathbb{S}, m \in \mathbb{M}
\end{multline}

\subsubsection{محدودیت منابع پردازشی}

\begin{equation}
    \sum_{k \in \mathbb{K}_e,e \in \mathbb{E}} x_{k,e,s} f^{con}_k \leq F_s \quad \forall s \in \mathbb{S}
\end{equation}
\begin{equation}
    \sum_{k \in \mathbb{K}_e} x_{k,e,0} f^{loc}_k \leq F_e \quad \forall e \in \mathbb{E}
\end{equation}

\subsubsection{مزاحمت و تاخیر پردازش}

\begin{multline} \label{transmission_delay}
    D_{k,e,s} = \left(\sum_{j \in \mathbb{K}_{e'}, e' \in \mathbb{E}} x_{j,e',s}\right) \left(\frac{I_k}{R_{w,e,s}} + \frac{I_k}{R_{f,s}} + \right. \\ \left. \frac{O_k}{R_{f,s}} + \frac{O_k}{R_{w,e,s}} \right) \quad \forall k \in \mathbb{K}_e, e \in \mathbb{E}, s \in \mathbb{S}
\end{multline}

\begin{equation}\label{local_exec_time}
    x_{k,e,0}\frac{L_k}{f^{loc}_k} \quad \forall k \in \mathbb{K}_e, e \in \mathbb{E}
\end{equation}

\begin{multline}
    \sum_{s \in \mathbb{S}} x_{k,e,s} \left(D_{k,e,s} + \sum_{m \in \mathbb{M}} \frac{z_{s,m} L_k}{f^{con}_k} C_{k,\mathbb{A}_m}\right) \\ \forall k \in \mathbb{K}_e, e \in \mathbb{E}
\end{multline} \label{off_time}

\begin{multline} \label{latency_con}
    x_{k,e,0}\frac{L_k}{f^{loc}_k} + \sum_{s \in \mathbb{S}} x_{k,e,s} \left(D_{k,e,s} + \sum_{m \in \mathbb{M}}\frac{L_k z_{s,m}}{f^{con}_k} C_{k,\mathbb{A}_m}\right) \\ \leq \Theta_k \quad \forall k \in \mathbb{K}_e, e \in \mathbb{E}
\end{multline}

\subsubsection{تابع هدف}

\begin{equation}
    \max_{x,z} \sum_{\substack{k \in \mathbb{K}_e, e \in \mathbb{E}\\ s \in \mathbb{S}}} x_{k,e,s}
\end{equation}

\subsection{خطی‌سازی قیود مساله بهینه‌سازی}

\subsubsection{خطی‌سازی تاخیر محاسبه بارسپاری شده}
We have nonlinear multiplication terms in latency formulation, we introduce $t_{k,s}$ and $u_{k,s}$ to linearize it:

\begin{equation}
    t_{k,s} = \sum_{m \in \mathbb{M}}\frac{L_k z_{s,m}}{f^{con}_k} C_{k,\mathbb{A}_m}
\end{equation}

\begin{equation}
    u_{k,s} = x_{k,e,s} t_{k,s}
\end{equation}

then impose:

\begin{equation}
    0 \leq u_{k,s} \leq t_{k,s}
\end{equation}

And we introduce $H^{max}_k = \max_m \frac{L_k C_{k,\mathbb{A}_m}}{f^{con}_k}$

\begin{equation}
    u_{k,s} \leq x_{k,e,s} H^{max}_k
\end{equation}

\begin{equation}
    u_{k,s} \geq t_{k,s} - (1-x_{k,e,s}) H^{max}_k
\end{equation}

\subsubsection{خطی‌سازی تاخیر مخابره}

And for the other nonlinear multiplication of variables, we introduce $q_s$ and $y_{k,e,s}$:

\begin{equation}
    q_s = \sum_{k \in \mathbb{K}_e, e \in \mathbb{E}} x_{k,e,s}
\end{equation}

\begin{equation}
    y_{k,e,s} = x_{k,e,s} q_s
\end{equation}

\begin{equation}
    0 \leq y_{k,e,s} \leq q_s
\end{equation}

\begin{equation}
    y_{k,e,s} \leq \mathcal{M} x_{k,e,s}
\end{equation}

\begin{equation}
    y_{k,e,s} \geq q_s - \mathcal{M} (1-x_{k,e,s})
\end{equation}

Then latency constraint is updated:

\begin{equation} \label{latency_con}
    x_{k,e,0}\frac{L_k}{f^{loc}_k} + \sum_{s \in \mathbb{S}} \left(y_{k,e,s} + u_{k,s}\right) \leq \Theta_k \quad \forall k \in \mathbb{K}_e, e \in \mathbb{E}
\end{equation}

\section{شبیه‌سازی}

\subsection{معیارهای برآورد عملکرد}

\subsection{طرح‌های رقیب}

\section{نتایج}
